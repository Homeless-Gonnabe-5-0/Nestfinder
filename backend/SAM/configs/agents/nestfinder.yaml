log:
  stdout_log_level: INFO

!include ../shared_config.yaml

# =============================================================================
# NESTFINDER: Ottawa Apartment Hunting Agent
# =============================================================================
# This agent helps users find apartments in Ottawa by:
# - Searching listings by budget, bedrooms, and preferences
# - Analyzing commute times to work
# - Evaluating neighborhood quality (safety, walkability, nightlife)
# - Comparing prices to market rates
# - Providing personalized recommendations
#
# Example usage:
#   "Find me a 1BR apartment in Ottawa between $1500-$2000"
#   "I work at 99 Bank Street. What's the commute from apt_002?"
#   "Is The Glebe a safe neighborhood?"
#   "Give me your top recommendation for apt_003"
# =============================================================================

apps:
  - name: nestfinder_app
    app_base_path: .
    app_module: solace_agent_mesh.agent.sac.app

    broker:
      <<: *broker_connection

    app_config:
      namespace: ${NAMESPACE, sam/}
      supports_streaming: true
      agent_name: "NestFinder"
      display_name: "NestFinder - Ottawa Apartment Hunter"
      model: *general_model

      instruction: |
        You are NestFinder, an AI apartment hunting assistant for Ottawa, Canada.
        You help renters find their perfect apartment based on their needs and lifestyle.

        CAPABILITIES:
        - Search apartments by budget, bedrooms, neighborhood, pet-friendly, parking
        - Analyze commute times to any work address (transit, driving, biking, walking)
        - Evaluate neighborhoods for safety, walkability, nightlife, quietness
        - Compare apartment prices to market rates (find good deals!)
        - Provide personalized recommendations with pros/cons

        AVAILABLE TOOLS:
        1. search_apartments - Find apartments matching criteria
        2. analyze_commute - Calculate commute times to work
        3. analyze_neighborhood - Evaluate area safety, walkability, amenities
        4. analyze_budget - Compare price to market rates
        5. get_apartment_recommendation - Full analysis with verdict

        WORKFLOW for helping users:
        1. Ask about their budget range (e.g., $1500-$2000/month)
        2. Ask how many bedrooms they need
        3. Ask where they work (for commute analysis)
        4. Ask what's important to them (short commute? safe area? nightlife? pets?)
        5. Use search_apartments to find matching listings
        6. For each promising apartment, use the analysis tools
        7. Present top 3-5 recommendations with clear explanations

        OTTAWA NEIGHBORHOODS you know about:
        - Downtown: Centretown, Byward Market, Sandy Hill
        - Central: The Glebe, Hintonburg, Little Italy, Westboro
        - Residential: Alta Vista, Vanier

        PRIORITIES users might have:
        - short_commute: They want to minimize travel time to work
        - safe_area: Safety is important to them
        - walkable: They want to walk to shops/restaurants
        - nightlife: They enjoy going out
        - quiet_area: They prefer a peaceful environment
        - pet_friendly: They have or want pets
        - parking: They need a parking spot
        - low_price: Budget is their main concern

        FORMATTING:
        - Use clear headings and bullet points
        - Always show the apartment price and neighborhood
        - Include commute time when relevant
        - Mention pros and cons for each recommendation
        - Be friendly and helpful!

        EXAMPLE RESPONSE for a recommendation:
        "Based on your needs, here's my top pick:

        ðŸ† **Sunny 1BR with Balcony - The Glebe** ($1,950/mo)
        - ðŸ“ 890 Bank Street, The Glebe
        - ðŸš— 22 min commute by transit
        - ðŸ˜ï¸ Excellent neighborhood (safe, walkable)
        - ðŸ’° At market rate
        - âœ… Pet-friendly, parking included, in-unit laundry

        This apartment scored 82/100 for your priorities!"

      tools:
        # NestFinder apartment tools
        - tool_type: python
          component_module: "src.apartment_tools"
          component_base_path: .
          function_name: "search_apartments"

        - tool_type: python
          component_module: "src.apartment_tools"
          component_base_path: .
          function_name: "analyze_commute"

        - tool_type: python
          component_module: "src.apartment_tools"
          component_base_path: .
          function_name: "analyze_neighborhood"

        - tool_type: python
          component_module: "src.apartment_tools"
          component_base_path: .
          function_name: "analyze_budget"

        - tool_type: python
          component_module: "src.apartment_tools"
          component_base_path: .
          function_name: "get_apartment_recommendation"

        # Built-in artifact tools (to save reports)
        - tool_type: builtin-group
          group_name: artifact_management

      session_service:
        type: ${PERSISTENCE_TYPE, memory}
        database_url: ${CUSTOM_AGENT_DATABASE_URL,}

      artifact_service: *default_artifact_service

      agent_card:
        description: >
          NestFinder is your Ottawa apartment hunting assistant. Tell me your budget,
          where you work, and what matters to you (commute, safety, nightlife, pets),
          and I'll find your perfect apartment. I can search listings, analyze commute
          times, evaluate neighborhoods, and compare prices to market rates.
          Examples: "Find me a 1BR apartment between $1500-$2000", "I work at 99 Bank Street,
          what's the best apartment for a short commute?", "Is Hintonburg a good neighborhood?"
        defaultInputModes: ["text"]
        defaultOutputModes: ["text", "file"]
        skills:
          - id: "apartment_search"
            name: "Apartment Search"
            description: "Find apartments by budget, bedrooms, and preferences"
          - id: "commute_analysis"
            name: "Commute Analysis"
            description: "Calculate travel times to work by transit, car, bike, or walking"
          - id: "neighborhood_analysis"
            name: "Neighborhood Analysis"
            description: "Evaluate safety, walkability, nightlife, and amenities"
          - id: "price_analysis"
            name: "Price Analysis"
            description: "Compare apartment prices to Ottawa market rates"
          - id: "recommendation"
            name: "Personalized Recommendation"
            description: "Get a full analysis with pros, cons, and verdict"

      agent_card_publishing:
        interval_seconds: 10

      agent_discovery:
        enabled: true

      inter_agent_communication:
        allow_list: ["OrchestratorAgent"]
        request_timeout_seconds: 60